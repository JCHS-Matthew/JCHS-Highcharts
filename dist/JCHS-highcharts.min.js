"use strict";!function(a){var b={logoURL:"http://www.jchs.harvard.edu/sites/default/files/harvard_jchs_logo_2017.png",standardOptions:{lang:{thousandsSep:",",contextButtonTitle:"Export Chart",downloadPDF:"Download as PDF",downloadCSV:"Download chart data (CSV)",downloadXLS:"Download chart data (Excel)"},chart:{spacing:[5,5,5,5],marginTop:40},title:{text:null},subtitle:{text:null},yAxis:{title:{text:null},labels:{format:"{value:,.0f}"},reversedStacks:!1},credits:{enabled:!1},tooltip:{enabled:!0,useHTML:!0,shared:!0},plotOptions:{series:{connectNulls:!0},spline:{marker:{enabled:!1}}},exporting:{enabled:!0,filename:"Chart - Harvard Joint Center for Housing Studies",chartOptions:{chart:{spacingTop:12,marginTop:50,marginBottom:130},title:{y:8},subtitle:{widthAdjust:-170,x:170,y:-28,align:"left",verticalAlign:"bottom"},series:{borderWidth:.5},legend:{y:-45}},menuItemDefinitions:{viewFullDataset:{text:"View full dataset"}},buttons:{contextButton:{text:"Export",menuItems:["viewFullDataset","separator","printChart","downloadPDF","separator","downloadPNG","downloadJPEG","separator","downloadXLS"]}}},navigation:{buttonOptions:{height:20,symbolY:8,symbolSize:12,theme:{padding:1}}}},drilldownOptions:{chart:{margin:void 0,marginTop:void 0,marginBottom:40,marginLeft:50,marginRight:10},plotOptions:{series:{label:{enabled:!1}}},legend:{enabled:!1},mapNavigation:{enabled:!1},exporting:{enabled:!1}}};b.createSearchBox=function(a,c,d,e,f,g){b.createSearchBoxes.apply(b,[1].concat(Array.prototype.slice.call(arguments)))},b.createSearchBoxes=function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"dropdown",g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"default";"search"===f&"default"===g&&(g="Search for metro..."),"default"===g&&(g="Select a metro..."),a=Math.min(a,8),""!==d&"_"!==d.charAt(0)&&(d="_"+d);for(var h=0;h<a;)!function(a){$("#search_box"+d).append('\n          <input id="search_input'+d+"_"+a+'" class="JCHS-chart__search-box__input" autocomplete="off">\n        ');var h=$("#search_input"+d+"_"+a);Array.isArray(g)?h.attr("placeholder",g[a]):h.attr("placeholder",g),"dropdown"!=f&&h.css("background-image","none"),h.after('<ul id="search_list'+d+"_"+a+'" class="JCHS-chart__search-box__list"></ul>');var i=$("#search_list"+d+"_"+a),j=[];b.forEach(function(a){j.indexOf(a[e])<0&&j.push(a[e])}),j.forEach(function(a){return i.append("<li>"+a+"</li>")}),h.on("focus",function(){h.val(""),i.show()}),h.on("keyup focus",function(){var a=h.val().toUpperCase();$("li").each(function(){$(this).html().toUpperCase().indexOf(a)>-1?$(this).css("display","block"):$(this).css("display","none")})}),h.on("change",function(){var a=[];$(".JCHS-chart__search-box").children("input").each(function(){a.push($(this).val())}),c.apply(void 0,a),h.blur(),i.hide()}),h.on("blur",function(){i.hide()}),i.on("mousedown","li",function(a){h.val(a.target.innerHTML),h.change()})}(h),h++},b.yAxisTitle=function(a,b,c){if(a.renderer.text(b).addClass("highcharts-axis-title").align({y:-5},!1,"plotBox").add(),"string"==typeof c){var d=a.renderer.text(c).addClass("highcharts-axis-title").align({align:"right",y:-5},!1,"plotBox").add(),e=d.getBBox();d.translate(-e.width,0)}},b.responsiveAnnotation=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-20,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bottom",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"center",g=$(".JCHS-chart__text-annotation");null!=g&&g.each(function(a,c){c.innerHTML.search(b)>-1&&c.remove()});var h=a.renderer.text(b).addClass("JCHS-chart__text-annotation").align({align:f,verticalAlign:e,x:c,y:d},!1,"plotBox").add(),i=h.getBBox();switch(f){case"center":h.translate(-i.width/2,0);break;case"right":h.translate(-i.width,0)}},b.mapLocatorCircle=function(a,b){a.series[0].points.forEach(function(c,d){c.name==b&&(a.series[0].points[d].select(!0),a.renderer.circle(a.series[0].points[d].plotX,a.series[0].points[d].plotY+a.margin[0],150).attr({fill:"transparent",stroke:"black","stroke-width":1}).animate({r:0}).add().toFront()),setTimeout(function(){return a.series[0].points[d].select(!1)},700)})},b.requestURL=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Sheet1",c="https://sheets.googleapis.com/v4/spreadsheets/",d="AIzaSyDY_gHLV0A7liVYq64RxH7f7IYUKF15sOQ",e="valueRenderOption=UNFORMATTED_VALUE",f=c+a+"/values/"+b+"?key="+d+"&"+e;return console.log(f),f},b.addTableNotes=function(b,c){if(b.options.hasOwnProperty("JCHS")&&b.options.JCHS.hasOwnProperty("tableNotes"))var d=b.options.JCHS.tableNotes;var e=a.pick(c,d,""),f=b.renderer.text(e).css({width:"420px"}).addClass("JCHS-chart__table-notes--exporting").align({align:"right",verticalAlign:"bottom",x:-10,y:8}).add(),g=f.getBBox();f.translate(-g.width,-g.height)},b.numFormat=function(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return a.numberFormat(b,c,".",",")},a.JCHS=b,a.setOptions(b.standardOptions),a.Chart.prototype.callbacks.push(function(c){c.renderer.forExport&&(c.renderer.image(b.logoURL,0,c.chartHeight-50,170,55).add(),a.JCHS.addTableNotes(c)),c.options.exporting.hasOwnProperty("JCHS")&&c.options.exporting.JCHS.hasOwnProperty("sheetID")&&c.update({exporting:{menuItemDefinitions:{viewFullDataset:{text:"View full dataset",onclick:function(){window.open("https://docs.google.com/spreadsheets/d/"+c.options.exporting.JCHS.sheetID)}}}}})}),a.wrap(a.Chart.prototype,"render",function(b){b.apply(this,Array.prototype.slice.call(arguments,1)),a.JCHS.yAxisTitle(this,this.options.JCHS.yAxisTitle,this.options.JCHS.yAxisTitle2)})}(Highcharts);