"use strict";!function(a){var b={logoURL:"http://www.jchs.harvard.edu/sites/default/files/harvard_jchs_logo_2017.png",standardOptions:{lang:{thousandsSep:",",contextButtonTitle:"Export Chart",downloadPDF:"Download as PDF",downloadCSV:"Download chart data (CSV)",downloadXLS:"Download chart data (Excel)"},chart:{spacing:[5,5,5,5],marginTop:40},title:{text:null},subtitle:{text:null},yAxis:{title:{text:null},labels:{format:"{value:,.0f}"}},credits:{enabled:!1},tooltip:{enabled:!0,useHTML:!0,shared:!0},plotOptions:{series:{connectNulls:!0},spline:{marker:{enabled:!1}}},exporting:{enabled:!0,filename:"Chart - Harvard Joint Center for Housing Studies",chartOptions:{chart:{spacingTop:12,marginTop:50,marginBottom:130},title:{y:8},subtitle:{widthAdjust:-170,x:170,y:-28,align:"left",verticalAlign:"bottom"},series:{borderWidth:.5},legend:{y:-45}},menuItemDefinitions:{viewFullDataset:{text:"View full dataset"}},buttons:{contextButton:{text:"Export",menuItems:["viewFullDataset","separator","printChart","downloadPDF","separator","downloadPNG","downloadJPEG","separator","downloadXLS"]}}},navigation:{buttonOptions:{height:20,symbolY:8,symbolSize:12,theme:{padding:1}}}},colors6:{color1:"#467b91",color2:"#8db8c9",color3:"#c8ded6",color4:"#f6e599",color5:"#eab700",color6:"#c14d00"}};b.createSearchBox=function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"dropdown",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"Select a metro...";"search"===e&&(f="Search for metro..."),$("#search_box_"+b).append('<input id="search_input_'+b+'" class="JCHS-search-input">');var g=$("#search_input_"+b);g.attr("placeholder",f),"dropdown"!=e&&g.css("background-image","none"),g.after('<ul id="search_list_'+b+'" class="JCHS-search-list"></ul>');var h=$("#search_list_"+b),i=[];a.forEach(function(a){i.indexOf(a[d])<0&&i.push(a[d])}),i.forEach(function(a){return h.append("<li>"+a+"</li>")}),g.on("focus",function(){g.val(""),h.show()}),g.on("keyup focus",function(){var a=g.val().toUpperCase();$("li").each(function(){$(this).html().toUpperCase().indexOf(a)>-1?$(this).css("display","block"):$(this).css("display","none")})}),g.on("change",function(){c($("#search_input_"+b).val()),g.blur(),h.hide()}),g.on("blur",function(){h.hide()}),h.on("mousedown","li",function(a){g.val(a.target.innerHTML),g.change()})},b.createSearchBoxes=function(a,b,c,d){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"dropdown",g=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"Select a metro...";"search"===f&&(g="Search for metro..."),a=Math.min(a,8),console.log(a);for(var h=0;h<a;)!function(a){$("#search_box_"+c).append('<input id="search_input_'+c+"_"+a+'" class="JCHS-search-input '+c+'">');var h=$("#search_input_"+c+"_"+a),i=g;Array.isArray(g)&&(i=g[a]),h.attr("placeholder",i),"dropdown"!=f&&h.css("background-image","none"),h.after('<ul id="search_list_'+c+"_"+a+'" class="JCHS-search-list"></ul>');var j=$("#search_list_"+c+"_"+a),k=[];b.forEach(function(a){k.indexOf(a[e])<0&&k.push(a[e])}),k.forEach(function(a){return j.append("<li>"+a+"</li>")}),h.on("focus",function(){h.val(""),j.show()}),h.on("keyup focus",function(){var a=h.val().toUpperCase();$("li").each(function(){$(this).html().toUpperCase().indexOf(a)>-1?$(this).css("display","block"):$(this).css("display","none")})}),h.on("change",function(){var a=[];$("#search_box_"+c).children("input").each(function(){a.push($(this).val())}),d.apply(null,a),h.blur(),j.hide()}),h.on("blur",function(){j.hide()}),j.on("mousedown","li",function(a){h.val(a.target.innerHTML),h.change()})}(h),h++},b.yAxisTitle=function(a,b,c){if(a.renderer.text(b).addClass("highcharts-axis-title").align({y:-5},!1,"plotBox").add(),"string"==typeof c){var d=a.renderer.text(c).addClass("highcharts-axis-title").align({align:"right",y:-5},!1,"plotBox").add(),e=d.getBBox();d.translate(-e.width,0)}},b.responsiveAnnotation=function(a,b){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-20,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"bottom",e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"center",f=document.querySelectorAll("#jchs-rendered-text");null!=f&&f.forEach(function(a){return a.parentNode.removeChild(a)});var g=this.plotWidth>200?"1.2em":"1em",h=a.renderer.text(b).css({fontSize:g}).attr({id:"jchs-rendered-text"}).align({align:e,verticalAlign:d,y:c},!1,"plotBox").add(),i=h.getBBox();h.translate(-i.width/2,0)},b.mapLocatorCircle=function(a,b){a.series[0].points.forEach(function(c,d){c.name==b&&(a.series[0].points[d].select(!0),a.renderer.circle(a.series[0].points[d].plotX,a.series[0].points[d].plotY+a.margin[0],150).attr({fill:"transparent",stroke:"black","stroke-width":1}).animate({r:0}).add().toFront()),setTimeout(function(){return a.series[0].points[d].select(!1)},700)})},b.requestURL=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Sheet1",c="https://sheets.googleapis.com/v4/spreadsheets/",d="AIzaSyDY_gHLV0A7liVYq64RxH7f7IYUKF15sOQ",e="valueRenderOption=UNFORMATTED_VALUE",f=c+a+"/values/"+b+"?key="+d+"&"+e;return console.log(f),f},b.numFormat=function(a,b){a=+a||0,b=+b;var c,d,e,f,g=(a.toString().split(".")[1]||"").length,h=".",i=",";return-1===b?b=Math.min(g,20):isNaN(b)&&(b=Math.min(g,2)),f=(Math.abs(a)+Math.pow(10,-Math.max(b,g)-1)).toFixed(b),c=String(parseInt(f)),d=c.length>3?c.length%3:0,e=a<0?"-":"",e+=d?c.substr(0,d)+i:"",e+=c.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+i),b&&(e+=h+f.slice(-b)),e},a.JCHS=b,a.setOptions(b.standardOptions),a.Chart.prototype.callbacks.push(function(a){a.renderer.forExport&&a.renderer.image(b.logoURL,0,a.chartHeight-50,170,55).add(),a.update({exporting:{menuItemDefinitions:{viewFullDataset:{text:"View full dataset",onclick:function(){window.open("https://docs.google.com/spreadsheets/d/"+a.options.JCHS.sheetID)}}}}})}),a.wrap(a.Chart.prototype,"render",function(b){b.apply(this,Array.prototype.slice.call(arguments,1)),a.JCHS.yAxisTitle(this,this.options.JCHS.yAxisTitle,this.options.JCHS.yAxisTitle2)})}(Highcharts);